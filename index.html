<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Auction / Draft App</title>
  <style>
    /* ========== Timer Styles ========== */
    .timer-card {
      padding: 10px;
      margin: 10px;
      border-radius: 5px;
      display: inline-block;
      min-width: 120px;
      text-align: center;
      font-size: 1.5em;
      color: white;
    }
    .timer-card.inactive {
      background: #ccc;
      color: #555;
    }
    .timer-card.inactive .timer-display {
      color: #555;
    }
    .timer-card.active {
      background: red;
      color: white;
    }
    .timer-display {
      font-weight: bold;
    }

    /* ========== Teams / Cards / Roster Styles ========== */
    .teams-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-top: 20px;
    }
    .team-card {
      border: 1px solid #ccc;
      border-radius: 5px;
      padding: 15px;
      width: 200px;
      box-sizing: border-box;
    }
    .team-header {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }
    .team-logo {
      width: 50px;
      height: 50px;
      border: 1px solid #666;
      border-radius: 5px;
      background-size: cover;
      background-position: center;
      margin-right: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5em;
      color: white;
      background-color: #444;
    }
    .team-info h3 {
      margin: 0;
      font-size: 1.2em;
    }
    .team-info .coaches {
      font-size: 0.9em;
      color: #555;
    }
    ul {
      padding-left: 20px;
      margin: 0;
    }
    ul li {
      margin-bottom: 5px;
    }

    /* Admin/Setup Section Styling */
    .admin-section {
      margin-top: 40px;
      border: 1px solid #888;
      padding: 20px;
      border-radius: 8px;
    }
    .admin-section h2 {
      margin-top: 0;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
    }
    .controls {
      margin-top: 20px;
    }
    .controls button {
      padding: 10px 15px;
      margin-right: 10px;
    }
  </style>
</head>
<body>

  <h1>Auction / Drafting App</h1>

  <!-- Timers Section -->
  <div class="timers">
    <div id="countdown-timer-card" class="timer-card inactive">
      <span class="timer-display" id="countdown-timer">--</span>
      <div>Countdown Timer</div>
    </div>
    <div id="nomination-timer-card" class="timer-card inactive">
      <span class="timer-display" id="nomination-timer">--</span>
      <div>Nomination Timer</div>
    </div>
  </div>

  <!-- (Your existing buttons / controls for timers and auction would be here) -->
  <div class="controls">
    <button id="start-countdown">Start Countdown</button>
    <button id="pause-countdown">Pause Countdown</button>
    <button id="reset-countdown">Reset Countdown</button>
    <button id="start-nomination">Start Nomination</button>
    <button id="pause-nomination">Pause Nomination</button>
    <button id="reset-nomination">Reset Nomination</button>
  </div>

  <!-- ========== Admin Section: Team Info Setup ========== -->
  <div class="admin-section">
    <h2>Admin: Setup Teams</h2>
    <div class="form-group">
      <label>Team Names (Team 1 to Team 6)</label>
      <input type="text" id="team-names" placeholder="Comma separated: Team1,Team2,…Team6">
    </div>
    <div class="form-group">
      <label>Coaches’ Names (Team 1 to Team 6)</label>
      <input type="text" id="coach-names" placeholder="Comma separated coach names">
    </div>
    <div class="form-group">
      <label>Team Logos (Team 1 to Team 6)</label>
      <input type="file" id="team-logos" accept="image/*" multiple>
      <small>Upload images in order: Team1 → Team2 → ... → Team6</small>
    </div>
    <div class="form-group">
      <button id="save-setup">Save Setup</button>
    </div>
  </div>

  <!-- ========== Live Drafted Teams Display ========== -->
  <div class="live-teams-section">
    <h2>Live Team Rosters</h2>
    <div class="teams-grid" id="drafted-teams-grid">
      <!-- Team cards will be rendered here -->
    </div>
  </div>

  <script>
    // Existing auctionState or add if not already
    const auctionState = {
      teams: [],      // will hold array of {id, name, coaches, logo, players: []}
      countdown: 0,
      nomination: 0,
      countdownActive: false,
      nominationActive: false,
      currentTimer: null
    };

    // ===== Timer Functions =====
    function setTimerActive(type, isActive) {
      const card = document.getElementById(type + '-timer-card');
      const display = document.getElementById(type + '-timer');
      if (isActive) {
        card.classList.remove('inactive');
        card.classList.add('active');
        // Timer display will show the remaining time
      } else {
        card.classList.remove('active');
        card.classList.add('inactive');
        display.textContent = '--';
      }
    }

    function startTimer(type, duration) {
      // Stop any existing timer
      stopTimer(type);
      auctionState[type] = duration;
      auctionState[type + 'Active'] = true;
      setTimerActive(type, true);

      auctionState.currentTimer = setInterval(() => {
        if (auctionState[type] > 0) {
          auctionState[type]--;
          document.getElementById(type + '-timer').textContent = formatTime(auctionState[type]);
        } else {
          stopTimer(type);
        }
      }, 1000);
    }

    function stopTimer(type) {
      if (auctionState.currentTimer) {
        clearInterval(auctionState.currentTimer);
      }
      auctionState[type + 'Active'] = false;
      setTimerActive(type, false);
    }

    function resetTimer(type) {
      stopTimer(type);
      document.getElementById(type + '-timer').textContent = '--';
    }

    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = seconds % 60;
      return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
    }

    // Event listeners for timer buttons
    document.getElementById('start-countdown').addEventListener('click', () => {
      startTimer('countdown', 300); // example 5 min
    });
    document.getElementById('pause-countdown').addEventListener('click', () => {
      stopTimer('countdown');
    });
    document.getElementById('reset-countdown').addEventListener('click', () => {
      resetTimer('countdown');
    });

    document.getElementById('start-nomination').addEventListener('click', () => {
      startTimer('nomination', 120); // example 2 min
    });
    document.getElementById('pause-nomination').addEventListener('click', () => {
      stopTimer('nomination');
    });
    document.getElementById('reset-nomination').addEventListener('click', () => {
      resetTimer('nomination');
    });

    // ===== Admin Setup: Team Info =====
    document.getElementById('save-setup').addEventListener('click', saveSetup);

    function saveSetup() {
      const teamNamesRaw = document.getElementById('team-names').value;
      const coachNamesRaw = document.getElementById('coach-names').value;
      const logosInput = document.getElementById('team-logos');

      const teamNames = teamNamesRaw.split(',').map(s => s.trim()).filter(s => s !== '');
      const coachNames = coachNamesRaw.split(',').map(s => s.trim()).filter(s => s !== '');
      const files = logosInput.files;

      // Ensure 6 entries
      for (let i = teamNames.length; i < 6; i++) teamNames.push(`Team ${i+1}`);
      for (let i = coachNames.length; i < 6; i++) coachNames.push(`Coach ${i+1}`);

      auctionState.teams = [];
      for (let i = 0; i < 6; i++) {
        let logoUrl = null;
        if (files[i]) {
          logoUrl = URL.createObjectURL(files[i]);
        }
        auctionState.teams.push({
          id: i,
          name: teamNames[i],
          coaches: coachNames[i],
          logo: logoUrl,  
          players: []
        });
      }

      updateLiveDraftedTeams();
    }

    // ===== Draft / Bidding Function to record picks =====
    function finalizeBid(teamId, playerName, playerCost) {
      const team = auctionState.teams.find(t => t.id === teamId);
      if (!team) return;
      team.players.push({ name: playerName, cost: playerCost });
      updateLiveDraftedTeams();
    }

    // ===== Live Drafted Teams Rendering =====
    function updateLiveDraftedTeams() {
      const container = document.getElementById('drafted-teams-grid');
      container.innerHTML = '';

      auctionState.teams.forEach(team => {
        const playersHtml = team.players.length
          ? team.players.map(p => `<li>${p.name} – ₹${p.cost}</li>`).join('')
          : '<li>No picks yet</li>';
        const card = document.createElement('div');
        card.className = 'team-card';
        card.innerHTML = `
          <div class="team-header">
            <div class="team-logo" style="${team.logo ? `background-image: url('${team.logo}');` : ''}">
              ${!team.logo ? team.name.charAt(0).toUpperCase() : ''}
            </div>
            <div class="team-info">
              <h3>${team.name}</h3>
              <div class="coaches">${team.coaches}</div>
            </div>
          </div>
          <ul>${playersHtml}</ul>
        `;
        container.appendChild(card);
      });
    }

    // You can call updateLiveDraftedTeams() in other places in your flow
    // E.g. after auction reset, after your renderTeams() if it updates teams, etc.

  </script>
</body>
</html>
